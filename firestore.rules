rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Products Collection
    match /products/{productId} {
      // อนุญาตให้ทุกคนอ่านได้ (สำหรับลูกค้า)
      allow read: if true;
      
      // เฉพาะ login แล้วเท่านั้นที่เขียนได้
      allow create, update, delete: if request.auth != null;
    }
    
    // Orders Collection
    match /orders/{orderId} {
      // ทุกคน (login หรือไม่ login) สามารถอ่านได้ (สำหรับ testing)
      // ⚠️ ใช้เฉพาะ dev เท่านั้น! ต้องเปลี่ยนเมื่อ production
      allow read: if true;
      
      // ลูกค้าสามารถสร้างคำสั่งซื้อได้ (ไม่ต้อง login)
      allow create: if true;
      
      // เฉพาะ login แล้วเท่านั้นที่แก้ไขและลบได้
      allow update, delete: if request.auth != null;
    }
    
    // Admins Collection
    match /admins/{uid} {
      allow read: if true;
      allow write: if false;
    }
  }
}

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function - ตรวจสอบว่าเป็น admin หรือไม่
    function isAdmin() {
      return request.auth != null;
    }
    
    // Products Collection
    match /products/{productId} {
      // อนุญาตให้ทุกคนอ่านได้ (สำหรับลูกค้า)
      allow read: if true;
      
      // เฉพาะ admin ที่ login แล้วเท่านั้นที่เขียนได้
      allow create, update, delete: if isAdmin();
    }
    
    // Orders Collection
    match /orders/{orderId} {
      // เฉพาะ admin ที่อ่านได้ทั้งหมด
      allow read: if isAdmin();
      
      // ลูกค้าสามารถสร้างคำสั่งซื้อได้ (ไม่ต้อง login)
      allow create: if true;
      
      // เฉพาะ admin ที่แก้ไขและลบได้
      allow update, delete: if isAdmin();
    }
  }
}
